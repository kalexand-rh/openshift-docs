// Module included in the following assemblies:
//
// * architecture/networking.adoc

[id='alternate-backends-weights-{context}']
= Alternate backends and weights

A route is usually associated with one service through the `to:` token with
`kind: Service`. All of the requests to the route are handled by endpoints in
the service based on the load balancing strategy.

It is possible to have as many as four services supporting the route. The
portion of requests that are handled by each service is governed by the service
`weight`.

The first service is entered using the `to:` token as before, and up to three
additional services can be entered using the `alternateBackend:` token. Each
service must be `kind: Service` which is the default.

Each service has a `weight` associated with it. The portion of requests
handled  by the service is `weight` / `sum_of_all_weights`. When a service has
more than one  endpoint, the service's weight is distributed among the endpoints
with each endpoint getting at least 1. If the service `weight` is 0 each
of the service's endpoints will get 0.

The `weight` must be in the range 0-256. The default is 1. When the `weight` is
0, the service does not participate in load-balancing but continues to serve
existing persistent connections.

When using `alternateBackends` also use the `roundrobin` load balancing strategy to ensure requests are distributed
as expected to the services based on `weight`. `roundrobin` can be set for a
route using a route annotation or for the
router in general using an environment variable.

