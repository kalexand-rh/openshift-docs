// Module included in the following assemblies:
//
// * TBD

[id="installation-adding-registry-pull-secret_{context}"]
= Adding the registry to your pull secret

Modify your the pull secret for your {product-title} cluster to describe
your local registry before you install an {product-title} cluster in a
restricted network.

.Prerequisites

* You configured a mirror registry to use in your restricted network.

.Procedure

Complete the following steps on the bastion host:

. Generate the pull secret for your registry:
+
----
$ podman login --authfile ~/pullsecret_config.json <local_registry_host_name>:<local_registry_host_port> <1>
----
<1> For `<local_registry_host_name>`, specify the registry domain name
for your mirror registry, such as `registry.example.com`. For
`<local_registry_host_port>`, specify the port that your mirror registry uses to
serve content.
+
Provide your credentials for the mirror registry at the prompts.

. View the pull secret that you created and record the pull secret value:
+
----
# cat ~/pullsecret_config.json

{ "auths": { "<local_registry_host_name>:<local_registry_host_port>": { "auth": "ZHVtbXk6ZHVtbXk=" } } }
----

. Download your pull secret from the
link:https://cloud.redhat.com/openshift/install/pull-secret[Pull Secret] page on the {cloud-redhat-com} site.

. Make a copy of the {cloud-redhat-com} link:https://cloud.redhat.com/openshift/install/pull-secret[Pull Secret] that you downloaded in JSON format:
+
----
$ cat ./pull-secret.text | jq .  > <path>/<pull-secret-file><1>
----
<1> Specify the path to the folder to store the pull secret in and a name for
the JSON file that you create.
+
The contents of the file resemble the following example:
+
----
{
  "auths": {
    "cloud.openshift.com": {
      "auth": "b3BlbnNo...",
      "email": "you@example.com"
    },
    "quay.io": {
      "auth": "b3BlbnNo...",
      "email": "you@example.com"
    },
    "registry.connect.redhat.com": {
      "auth": "NTE3Njg5Nj...",
      "email": "you@example.com"
    },
    "registry.redhat.io": {
      "auth": "NTE3Njg5Nj...",
      "email": "you@example.com"
    }
  }
}
----

. Edit the {cloud-redhat-com} link:https://cloud.redhat.com/openshift/install/pull-secret[Pull Secret] file and add a section that describes your registry to it:
+
----
  "auths": { <1>
...
    "<local_registry_host_name>:<local_registry_host_port>": { <1>
      "auth": "<credentials>", <2>
      "email": "you@example.com"
  },
...
----
<1> Paste the contents of the `pullsecret_config.json` file that you created.
+
The file resembles the following example:
+
----
{
  "auths": {
    "cloud.openshift.com": {
      "auth": "b3BlbnNo...",
      "email": "you@example.com"
    },
    "quay.io": {
      "auth": "b3BlbnNo...",
      "email": "you@example.com"
    },
    "registry.connect.redhat.com": {
      "auth": "NTE3Njg5Nj...",
      "email": "you@example.com"
    },
    "<local_registry_host_name>:<local_registry_host_port>": {
      "auth": "<credentials>",
      "email": "you@example.com"
    },
    "registry.redhat.io": {
      "auth": "NTE3Njg5Nj...",
      "email": "you@example.com"
    }
  }
}
----
